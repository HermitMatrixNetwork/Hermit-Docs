
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>events · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="grpc_rest.html" />
    
    
    <link rel="prev" href="交易查询语法.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    hermit matrix network
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../节点搭建/">
            
                <a href="../节点搭建/">
            
                    
                    节点搭建
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../节点搭建/环境搭建.html">
            
                <a href="../节点搭建/环境搭建.html">
            
                    
                    环境搭建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../节点搭建/引导节点搭建.html">
            
                <a href="../节点搭建/引导节点搭建.html">
            
                    
                    引导节点搭建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../节点搭建/全节点搭建.html">
            
                <a href="../节点搭建/全节点搭建.html">
            
                    
                    全节点搭建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../配置解析/">
            
                <a href="../配置解析/">
            
                    
                    配置解析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../配置解析/app配置解析.html">
            
                <a href="../配置解析/app配置解析.html">
            
                    
                    app配置解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../配置解析/config配置解析.html">
            
                <a href="../配置解析/config配置解析.html">
            
                    
                    config配置解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../配置解析/client配置解析.html">
            
                <a href="../配置解析/client配置解析.html">
            
                    
                    client配置解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../配置解析/genesis配置解析.html">
            
                <a href="../配置解析/genesis配置解析.html">
            
                    
                    genesis配置解析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../验证人/">
            
                <a href="../验证人/">
            
                    
                    验证人
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../验证人/验证器操作指南.html">
            
                <a href="../验证人/验证器操作指南.html">
            
                    
                    验证器操作指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../验证人/验证器常见的问题.html">
            
                <a href="../验证人/验证器常见的问题.html">
            
                    
                    验证器常见的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../验证人/验证器的安全.html">
            
                <a href="../验证人/验证器的安全.html">
            
                    
                    验证器的安全
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../委托人/">
            
                <a href="../委托人/">
            
                    
                    委托人
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../委托人/委托人操作指南.html">
            
                <a href="../委托人/委托人操作指南.html">
            
                    
                    委托人操作指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../委托人/委托人常见的问题.html">
            
                <a href="../委托人/委托人常见的问题.html">
            
                    
                    委托人常见的问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../治理/">
            
                <a href="../治理/">
            
                    
                    治理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../治理/治理概述.html">
            
                <a href="../治理/治理概述.html">
            
                    
                    治理概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../治理/治理操作指南.html">
            
                <a href="../治理/治理操作指南.html">
            
                    
                    治理操作指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../治理/可治理参数索引.html">
            
                <a href="../治理/可治理参数索引.html">
            
                    
                    可治理参数索引
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../合约教程/">
            
                <a href="../合约教程/">
            
                    
                    合约教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../合约教程/合约快速上手.html">
            
                <a href="../合约教程/合约快速上手.html">
            
                    
                    合约快速上手
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../合约教程/合约列表.html">
            
                <a href="../合约教程/合约列表.html">
            
                    
                    合约列表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="./">
            
                <a href="./">
            
                    
                    链上数据获取
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="链上接口.html">
            
                <a href="链上接口.html">
            
                    
                    链上接口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="交易查询语法.html">
            
                <a href="交易查询语法.html">
            
                    
                    交易查询语法
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="8.1.3" data-path="events.html">
            
                <a href="events.html">
            
                    
                    events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.4" data-path="grpc_rest.html">
            
                <a href="grpc_rest.html">
            
                    
                    grpc_rest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >events</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!--
order: 9
-->
<h1 id="events">Events</h1>
<p><code>Event</code>s are objects that contain information about the execution of the application. They are mainly used by service providers like block explorers and wallet to track the execution of various messages and index transactions. {synopsis}</p>
<h2 id="pre-requisite-readings">Pre-requisite Readings</h2>
<ul>
<li><a href="../basics/app-anatomy.md">Anatomy of an SDK application</a> {prereq}</li>
<li><a href="https://docs.tendermint.com/master/spec/abci/abci.html#events" target="_blank">Tendermint Documentation on Events</a> {prereq}</li>
</ul>
<h2 id="events">Events</h2>
<p>Events are implemented in the Cosmos SDK as an alias of the ABCI <code>Event</code> type and
take the form of: <code>{eventType}.{attributeKey}={attributeValue}</code>.</p>
<p>+++ <a href="https://github.com/tendermint/tendermint/blob/v0.34.8/proto/tendermint/abci/types.proto#L304-L313" target="_blank">https://github.com/tendermint/tendermint/blob/v0.34.8/proto/tendermint/abci/types.proto#L304-L313</a></p>
<p>An Event contains:</p>
<ul>
<li>A <code>type</code> to categorize the Event at a high-level; for example, the SDK uses the <code>&quot;message&quot;</code> type to filter Events by <code>Msg</code>s.</li>
<li>A list of <code>attributes</code> are key-value pairs that give more information about the categorized Event. For example, for the <code>&quot;message&quot;</code> type, we can filter Events by key-value pairs using <code>message.action={some_action}</code>, <code>message.module={some_module}</code> or <code>message.sender={some_sender}</code>.</li>
</ul>
<p>::: tip
To parse the attribute values as strings, make sure to add <code>&apos;</code> (single quotes) around each attribute value.
:::</p>
<p>Events, the <code>type</code> and <code>attributes</code> are defined on a <strong>per-module basis</strong> in the module&apos;s
<code>/types/events.go</code> file, and triggered from the module&apos;s Protobuf <a href="../building-modules/msg-services.md"><code>Msg</code> service</a>
by using the <a href="#eventmanager"><code>EventManager</code></a>. In addition, each module documents its Events under
<code>spec/xx_events.md</code>.</p>
<p>Events are returned to the underlying consensus engine in the response of the following ABCI messages:</p>
<ul>
<li><a href="baseapp.md#beginblock"><code>BeginBlock</code></a></li>
<li><a href="baseapp.md#endblock"><code>EndBlock</code></a></li>
<li><a href="baseapp.md#checktx"><code>CheckTx</code></a></li>
<li><a href="baseapp.md#delivertx"><code>DeliverTx</code></a></li>
</ul>
<h3 id="examples">Examples</h3>
<p>The following examples show how to query Events using the SDK.</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tx.height=23</code></td>
<td>Query all transactions at height 23</td>
</tr>
<tr>
<td><code>message.action=&apos;/cosmos.bank.v1beta1.Msg/Send&apos;</code></td>
<td>Query all transactions containing a x/bank <code>Send</code> <a href="../building-modules/msg-services.md">Service <code>Msg</code></a>. Note the <code>&apos;</code>s around the value.</td>
</tr>
<tr>
<td><code>message.action=&apos;send&apos;</code></td>
<td>Query all transactions containing a x/bank <code>Send</code> <a href="../building-modules/msg-services.md#legacy-amino-msgs">legacy <code>Msg</code></a>. Note the <code>&apos;</code>s around the value.</td>
</tr>
<tr>
<td><code>message.module=&apos;bank&apos;</code></td>
<td>Query all transactions containing messages from the x/bank module. Note the <code>&apos;</code>s around the value.</td>
</tr>
<tr>
<td><code>create_validator.validator=&apos;cosmosval1...&apos;</code></td>
<td>x/staking-specific Event, see <a href="../../../cosmos-sdk/x/staking/spec/07_events.md">x/staking SPEC</a>.</td>
</tr>
</tbody>
</table>
<h2 id="eventmanager">EventManager</h2>
<p>In Cosmos SDK applications, Events are managed by an abstraction called the <code>EventManager</code>.
Internally, the <code>EventManager</code> tracks a list of Events for the entire execution flow of a
transaction or <code>BeginBlock</code>/<code>EndBlock</code>.</p>
<p>+++ <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.42.1/types/events.go#L17-L25" target="_blank">https://github.com/cosmos/cosmos-sdk/blob/v0.42.1/types/events.go#L17-L25</a></p>
<p>The <code>EventManager</code> comes with a set of useful methods to manage Events. The method
that is used most by module and application developers is <code>EmitEvent</code> that tracks
an Event in the <code>EventManager</code>.</p>
<p>+++ <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.42.1/types/events.go#L33-L37" target="_blank">https://github.com/cosmos/cosmos-sdk/blob/v0.42.1/types/events.go#L33-L37</a></p>
<p>Module developers should handle Event emission via the <code>EventManager#EmitEvent</code> in each message
<code>Handler</code> and in each <code>BeginBlock</code>/<code>EndBlock</code> handler. The <code>EventManager</code> is accessed via
the <a href="context.md"><code>Context</code></a>, where Event emission generally follows this pattern:</p>
<pre><code class="lang-go">ctx.EventManager().EmitEvent(
    sdk.NewEvent(eventType, sdk.NewAttribute(attributeKey, attributeValue)),
)
</code></pre>
<p>Module&apos;s <code>handler</code> function should also set a new <code>EventManager</code> to the <code>context</code> to isolate emitted Events per <code>message</code>:</p>
<pre><code class="lang-go"><span class="hljs-keyword">func</span> NewHandler(keeper Keeper) sdk.Handler {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">func</span>(ctx sdk.Context, msg sdk.Msg) (*sdk.Result, error) {
        ctx = ctx.WithEventManager(sdk.NewEventManager())
        <span class="hljs-keyword">switch</span> msg := msg.(<span class="hljs-keyword">type</span>) {
</code></pre>
<p>See the <a href="../building-modules/msg-services.md"><code>Msg</code> services</a> concept doc for a more detailed
view on how to typically implement Events and use the <code>EventManager</code> in modules.</p>
<h2 id="subscribing-to-events">Subscribing to Events</h2>
<p>You can use Tendermint&apos;s <a href="https://docs.tendermint.com/master/tendermint-core/subscription.html#subscribing-to-events-via-websocket" target="_blank">Websocket</a> to subscribe to Events by calling the <code>subscribe</code> RPC method:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;jsonrpc&quot;</span>: <span class="hljs-string">&quot;2.0&quot;</span>,
  <span class="hljs-string">&quot;method&quot;</span>: <span class="hljs-string">&quot;subscribe&quot;</span>,
  <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
  <span class="hljs-string">&quot;params&quot;</span>: {
    <span class="hljs-string">&quot;query&quot;</span>: <span class="hljs-string">&quot;tm.event=&apos;eventCategory&apos; AND eventType.eventAttribute=&apos;attributeValue&apos;&quot;</span>
  }
}
</code></pre>
<p>The main <code>eventCategory</code> you can subscribe to are:</p>
<ul>
<li><code>NewBlock</code>: Contains Events triggered during <code>BeginBlock</code> and <code>EndBlock</code>.</li>
<li><code>Tx</code>: Contains Events triggered during <code>DeliverTx</code> (i.e. transaction processing).</li>
<li><code>ValidatorSetUpdates</code>: Contains validator set updates for the block.</li>
</ul>
<p>These Events are triggered from the <code>state</code> package after a block is committed. You can get the
full list of Event categories <a href="https://godoc.org/github.com/tendermint/tendermint/types#pkg-constants" target="_blank">on the Tendermint Godoc page</a>.</p>
<p>The <code>type</code> and <code>attribute</code> value of the <code>query</code> allow you to filter the specific Event you are looking for. For example, a <code>transfer</code> transaction triggers an Event of type <code>Transfer</code> and has <code>Recipient</code> and <code>Sender</code> as <code>attributes</code> (as defined in the <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.42.1/x/bank/types/events.go" target="_blank"><code>events.go</code> file of the <code>bank</code> module</a>). Subscribing to this Event would be done like so:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;jsonrpc&quot;</span>: <span class="hljs-string">&quot;2.0&quot;</span>,
  <span class="hljs-string">&quot;method&quot;</span>: <span class="hljs-string">&quot;subscribe&quot;</span>,
  <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
  <span class="hljs-string">&quot;params&quot;</span>: {
    <span class="hljs-string">&quot;query&quot;</span>: <span class="hljs-string">&quot;tm.event=&apos;Tx&apos; AND transfer.sender=&apos;senderAddress&apos;&quot;</span>
  }
}
</code></pre>
<p>where <code>senderAddress</code> is an address following the <a href="../basics/accounts.md#addresses"><code>AccAddress</code></a> format.</p>
<h2 id="typed-events-coming-soon">Typed Events (coming soon)</h2>
<p>As previously described, Events are defined on a per-module basis. It is the responsibility of the module developer to define Event types and Event attributes. Except in the <code>spec/XX_events.md</code> file, these Event types and attributes are unfortunately not easily discoverable, so the SDK proposes to use Protobuf-defined <a href="../architecture/adr-032-typed-events.md">Typed Events</a> for emitting and querying Events.</p>
<p>The Typed Events proposal has not yet been fully implemented. Documentation is not yet available.</p>
<h2 id="next-hide">Next {hide}</h2>
<p>Learn about SDK <a href="telemetry.md">telemetry</a> {hide}</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="交易查询语法.html" class="navigation navigation-prev " aria-label="Previous page: 交易查询语法">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="grpc_rest.html" class="navigation navigation-next " aria-label="Next page: grpc_rest">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"events","level":"8.1.3","depth":2,"next":{"title":"grpc_rest","level":"8.1.4","depth":2,"path":"链上数据获取/grpc_rest.md","ref":"./链上数据获取/grpc_rest.md","articles":[]},"previous":{"title":"交易查询语法","level":"8.1.2","depth":2,"path":"链上数据获取/交易查询语法.md","ref":"./链上数据获取/交易查询语法.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"链上数据获取/events.md","mtime":"2022-06-17T05:47:37.586Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-07-25T08:05:49.341Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

